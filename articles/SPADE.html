<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Spatial Association Detector(SPADE) • gdverse</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial Association Detector(SPADE)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gdverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/GD.html">Original Geographical Detector(GD)</a></li>
    <li><a class="dropdown-item" href="../articles/IDSA.html">Interactive Detector For Spatial Associations(IDSA)</a></li>
    <li><a class="dropdown-item" href="../articles/OPGD.html">Optimal Parameters-based Geographical Detector(OPGD)</a></li>
    <li><a class="dropdown-item" href="../articles/RGDRID.html">Robust Geographical Detector &amp; Robust Interaction Detector(RGD &amp; RID)</a></li>
    <li><a class="dropdown-item" href="../articles/SESU.html">Compare Size Effects of Spatial Units(SESU)</a></li>
    <li><a class="dropdown-item" href="../articles/SHEGD.html">Spatial Heterogeneity Explanation(GOZH &amp; LESH)</a></li>
    <li><a class="dropdown-item" href="../articles/SPADE.html">Spatial Association Detector(SPADE)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SpatLyu/gdverse/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Spatial Association Detector(SPADE)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SpatLyu/gdverse/blob/main/vignettes/SPADE.Rmd" class="external-link"><code>vignettes/SPADE.Rmd</code></a></small>
      <div class="d-none name"><code>SPADE.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="load-data-and-package">Load data and package<a class="anchor" aria-label="anchor" href="#load-data-and-package"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://spatlyu.github.io/gdverse/">gdverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">usfi</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/USFI_Xian.gpkg'</span>,package <span class="op">=</span> <span class="st">'gdverse'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">usfi</span></span>
<span><span class="co">## Simple feature collection with 1037 features and 19 fields</span></span>
<span><span class="co">## Geometry type: POLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 295713 ymin: 3784916 xmax: 324202.2 ymax: 3804669</span></span>
<span><span class="co">## Projected CRS: WGS 84 / UTM zone 49N</span></span>
<span><span class="co">## # A tibble: 1,037 × 20</span></span>
<span><span class="co">##      LPI   LSI   GAR    DAR      WAR   TER  NDVI   NDWI   DTH   DTP    DTR   DTW    BH    BD</span></span>
<span><span class="co">##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">##  1  57.2 10.5  0.630 0.273  0.00219  0.979 0.497 -0.356  5.66 1.08  0.934   1.16 3.16  0.635</span></span>
<span><span class="co">##  2  85.7  2.35 0.905 0.0952 0        0.977 0.514 -0.288  5.66 1.41  0.0807  1.57 0.310 0.139</span></span>
<span><span class="co">##  3  41.2  7.85 0.436 0.449  0.000672 0.972 0.365 -0.296  4.38 1.88  0.516   2.37 3.99  0.671</span></span>
<span><span class="co">##  4  39.1  5.40 0.534 0.377  0        0.966 0.395 -0.299  4.25 1.97  0.442   2.81 4.63  0.634</span></span>
<span><span class="co">##  5  32.0  8.04 0.405 0.437  0        0.968 0.354 -0.302  3.65 1.34  0.615   2.55 4.07  0.642</span></span>
<span><span class="co">##  6  58.3  7.91 0.332 0.615  0.000377 0.966 0.312 -0.271  3.69 0.700 0.592   2.25 7.91  0.777</span></span>
<span><span class="co">##  7  98.4  3.34 0.984 0.0161 0        0.948 0.451 -0.248  5.39 1.36  0.124   3.64 0.216 0.111</span></span>
<span><span class="co">##  8  44.6 17.6  0.416 0.502  0.000672 0.949 0.365 -0.295  5.11 1.20  0.926   2.50 6.49  0.747</span></span>
<span><span class="co">##  9  35.9  9.81 0.464 0.467  0.00134  0.936 0.379 -0.309  7.10 2.01  1.03    2.75 5.49  0.692</span></span>
<span><span class="co">## 10  44.3  9.49 0.403 0.504  0.000547 0.926 0.310 -0.278  8.51 2.68  0.658   3.20 3.27  0.601</span></span>
<span><span class="co">## # ℹ 1,027 more rows</span></span>
<span><span class="co">## # ℹ 6 more variables: RL &lt;dbl&gt;, RFD &lt;dbl&gt;, SVF &lt;dbl&gt;, FAR &lt;dbl&gt;, SUHI &lt;dbl&gt;, geom &lt;POLYGON [m]&gt;</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="../reference/figures/spade/studyarea.png" alt="The study area map of USFI_Xian data"><p class="caption">
The study area map of USFI_Xian data
</p>
</div>
<p>The polygon spatial data are the streets divided based on roads
within <em>the Ring expressway of Xi’an City</em>, and the attribute
data are the <em>SUHI</em>(surface urban heat island effect) and its
influence factors.</p>
<p>The meanings of each explanatory variable are as follows,and can be
divided into three categories:</p>
<ol style="list-style-type: decimal">
<li>Landscape pattern and Land cover characteristic indicators</li>
</ol>
<ul>
<li>
<code>LPI</code> Largest patch index (Area and Edge
metric)(landscape level)</li>
<li>
<code>LSI</code> Landscape shape index (Aggregation
metric)(landscape level)</li>
<li>
<code>GAR</code> The proportion of green space area</li>
<li>
<code>DAR</code> The proportion of industrial space area</li>
<li>
<code>WAR</code> The proportion of water space area</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Distances from cold and heat sources indicators</li>
</ol>
<ul>
<li>
<code>DTH</code> Distance to the nearest power plant(Heat
source)</li>
<li>
<code>DTP</code> Distance to the nearest urban park(Cold
source)</li>
<li>
<code>DTR</code> Distance to the nearest urban main road(Heat
source)</li>
<li>
<code>DTW</code> Distance to the nearest water body(Cold
source)</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Urban built space form indicators</li>
</ol>
<ul>
<li>
<code>BH</code> Building height</li>
<li>
<code>BD</code> Building density</li>
<li>
<code>RL</code> Roughness length</li>
<li>
<code>NDVI</code> Normalized Difference Vegetation Index</li>
<li>
<code>NDWI</code> Normalized Difference Water Index</li>
<li>
<code>RFD</code> Strewn degree (describing the roughness of
buildings in three dimensional space)</li>
<li>
<code>SVF</code> Sky View Factor (the ratio of the visible sky area
at a specific point or area to the total ground area in its surrounding
vicinity)</li>
<li>
<code>FAR</code> Floor Area Ratio (The ratio of the total floor area
of buildings on a site to the net land area of that site)</li>
<li>
<code>TER</code> Topographic Relief (The ratio of the average
elevation of the unit to the average elevation of the entire study
area)</li>
</ul>
<p>And the <code>SUHI</code> stands for surface urban heat island effect
intensity.</p>
</div>
<div class="section level3">
<h3 id="spatial-pattern-of-suhi">Spatial pattern of SUHI<a class="anchor" aria-label="anchor" href="#spatial-pattern-of-suhi"></a>
</h3>
<div class="section level4">
<h4 id="global-spatial-autocorrelation-of-suhi">global spatial autocorrelation of SUHI<a class="anchor" aria-label="anchor" href="#global-spatial-autocorrelation-of-suhi"></a>
</h4>
<p>here I use <code>sfdep</code> to calculate the global <strong>Moran’s
I</strong>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">global_moranI</span> <span class="op">=</span> \<span class="op">(</span><span class="va">data</span>,<span class="va">col</span>,<span class="va">nb</span>,<span class="va">wt</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">I</span> <span class="op">=</span> <span class="fu">sfdep</span><span class="fu">::</span><span class="fu"><a href="https://sfdep.josiahparry.com/reference/global_moran.html" class="external-link">global_moran</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">data</span>,<span class="op">{</span><span class="op">{</span><span class="va">col</span><span class="op">}</span><span class="op">}</span><span class="op">)</span>,</span>
<span>                          <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">data</span>,<span class="op">{</span><span class="op">{</span><span class="va">nb</span><span class="op">}</span><span class="op">}</span><span class="op">)</span>,</span>
<span>                          <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">data</span>,<span class="op">{</span><span class="op">{</span><span class="va">wt</span><span class="op">}</span><span class="op">}</span><span class="op">)</span>,</span>
<span>                          na_ok <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">$</span><span class="va">I</span></span>
<span>  <span class="va">PValue</span> <span class="op">=</span> <span class="fu">sfdep</span><span class="fu">::</span><span class="fu"><a href="https://sfdep.josiahparry.com/reference/global_moran_test.html" class="external-link">global_moran_test</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">data</span>,<span class="op">{</span><span class="op">{</span><span class="va">col</span><span class="op">}</span><span class="op">}</span><span class="op">)</span>,</span>
<span>                                    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">data</span>,<span class="op">{</span><span class="op">{</span><span class="va">nb</span><span class="op">}</span><span class="op">}</span><span class="op">)</span>,</span>
<span>                                    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">data</span>,<span class="op">{</span><span class="op">{</span><span class="va">wt</span><span class="op">}</span><span class="op">}</span><span class="op">)</span>,</span>
<span>                                    na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span>  <span class="va">moranI</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">I</span>,<span class="va">PValue</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">moranI</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Moran'I Index"</span>,<span class="st">"P Value"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">moranI</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">usfi</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">if_any</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,<span class="va">is.na</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>nb <span class="op">=</span> <span class="fu">sfdep</span><span class="fu">::</span><span class="fu"><a href="https://sfdep.josiahparry.com/reference/st_contiguity.html" class="external-link">st_contiguity</a></span><span class="op">(</span><span class="va">geom</span><span class="op">)</span>,</span>
<span>         wt <span class="op">=</span> <span class="fu">sfdep</span><span class="fu">::</span><span class="fu"><a href="https://sfdep.josiahparry.com/reference/st_weights.html" class="external-link">st_weights</a></span><span class="op">(</span><span class="va">nb</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">SUHI</span>,<span class="va">nb</span>,<span class="va">wt</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">new_usfi</span></span>
<span></span>
<span><span class="va">new_usfi</span></span>
<span><span class="co">## Simple feature collection with 1037 features and 3 fields</span></span>
<span><span class="co">## Geometry type: POLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 295713 ymin: 3784916 xmax: 324202.2 ymax: 3804669</span></span>
<span><span class="co">## Projected CRS: WGS 84 / UTM zone 49N</span></span>
<span><span class="co">## # A tibble: 1,037 × 4</span></span>
<span><span class="co">##     SUHI nb         wt                                                                      geom</span></span>
<span><span class="co">##    &lt;dbl&gt; &lt;nb&gt;       &lt;list&gt;                                                         &lt;POLYGON [m]&gt;</span></span>
<span><span class="co">##  1 1.76  &lt;int [12]&gt; &lt;dbl [12]&gt; ((297871.4 3787333, 297864.8 3787343, 297852.8 3787362, 297840.8…</span></span>
<span><span class="co">##  2 0.519 &lt;int [2]&gt;  &lt;dbl [2]&gt;  ((297398.6 3788768, 297397.5 3788779, 297395.2 3788804, 297393.2…</span></span>
<span><span class="co">##  3 3.04  &lt;int [9]&gt;  &lt;dbl [9]&gt;  ((297391.4 3789405, 297391 3789429, 297390.5 3789454, 297390.1 3…</span></span>
<span><span class="co">##  4 3.22  &lt;int [4]&gt;  &lt;dbl [4]&gt;  ((297244.1 3790712, 297240.4 3790729, 297235 3790751, 297229.6 3…</span></span>
<span><span class="co">##  5 3.47  &lt;int [6]&gt;  &lt;dbl [6]&gt;  ((296806.9 3791969, 296806.7 3791970, 296797.7 3791990, 296788.8…</span></span>
<span><span class="co">##  6 4.71  &lt;int [6]&gt;  &lt;dbl [6]&gt;  ((296484.5 3792805, 296481.4 3792815, 296474.7 3792837, 296467.9…</span></span>
<span><span class="co">##  7 1.24  &lt;int [2]&gt;  &lt;dbl [2]&gt;  ((296356.5 3793294, 296355.5 3793298, 296351.3 3793316, 296347.5…</span></span>
<span><span class="co">##  8 4.30  &lt;int [8]&gt;  &lt;dbl [8]&gt;  ((296154.6 3794673, 296152.3 3794688, 296148.6 3794713, 296144.9…</span></span>
<span><span class="co">##  9 3.76  &lt;int [5]&gt;  &lt;dbl [5]&gt;  ((296261.4 3798947, 296268.7 3798960, 296280.2 3798979, 296287.8…</span></span>
<span><span class="co">## 10 4.23  &lt;int [5]&gt;  &lt;dbl [5]&gt;  ((296996.6 3800017, 297000.9 3800022, 297013.3 3800038, 297025.5…</span></span>
<span><span class="co">## # ℹ 1,027 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123456789</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gmi</span> <span class="op">=</span> <span class="va">new_usfi</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">global_moranI</span><span class="op">(</span><span class="va">SUHI</span>,<span class="va">nb</span>,<span class="va">wt</span><span class="op">)</span></span>
<span><span class="va">gmi</span></span>
<span><span class="co">## Moran'I Index       P Value </span></span>
<span><span class="co">##  5.359564e-01 5.078059e-217</span></span></code></pre></div>
<p>The global Moran’s Index is 0.5359564 and the P value is 5.0780594 ×
10<sup>-217</sup>,which shows that SUHI in the main urban area of Xi’an
has significant positive spatial autocorrelation in the global
scale.</p>
</div>
<div class="section level4">
<h4 id="local-spatial-autocorrelation-of-suhi">local spatial autocorrelation of SUHI<a class="anchor" aria-label="anchor" href="#local-spatial-autocorrelation-of-suhi"></a>
</h4>
<p>We will use <code>tidyrgeoda</code> to run the <code>LISA</code>,
more details see <a href="https://spatlyu.github.io/tidyrgeoda/articles/Local-Indicators-of-Spatial-Association.html" class="external-link"><strong>here</strong></a></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">tidyrgeoda</span><span class="op">)</span></span>
<span></span>
<span><span class="va">new_usfi</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lisa <span class="op">=</span> <span class="fu">st_local_moran</span><span class="op">(</span><span class="va">.</span>,<span class="st">'SUHI'</span>,</span>
<span>                               wt <span class="op">=</span> <span class="fu">st_contiguity_weights</span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,</span>
<span>                               significance_cutoff <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lisa</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">lisa</span><span class="op">)</span>,lwd <span class="op">=</span> <span class="fl">.1</span>,color <span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_lisa</span><span class="op">(</span>name <span class="op">=</span> <span class="st">'SUHI-LISA'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7.5</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7.5</span><span class="op">)</span>,</span>
<span>    legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">'cm'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/spade/SUHI_LISA-1.png"></p>
<p>The global and local spatial autocorrelation shows that SUHI’s strong
spatial dependence.</p>
<p>Spatial dependence was neglected in native geodetector, which led to
the <strong>SPADE</strong> spatial association detector.</p>
</div>
</div>
<div class="section level3">
<h3 id="opgd-modeling">OPGD modeling<a class="anchor" aria-label="anchor" href="#opgd-modeling"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">usfi_opgd</span> <span class="op">=</span> <span class="fu"><a href="../reference/opgd.html">opgd</a></span><span class="op">(</span><span class="va">SUHI</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">usfi</span><span class="op">)</span>, discnum <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">15</span>,</span>
<span>                 discvar <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">usfi</span><span class="op">)</span>,<span class="op">-</span><span class="va">SUHI</span><span class="op">)</span><span class="op">)</span>,cores <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">usfi_opgd</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Spatial Stratified Heterogeneity Test </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##              Factor detector            </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## | variable | Q-statistic |   P-value    |</span></span>
<span><span class="co">## |:--------:|:-----------:|:------------:|</span></span>
<span><span class="co">## |   DAR    | 0.43933223  | 4.882348e-10 |</span></span>
<span><span class="co">## |   NDVI   | 0.39709785  | 2.024269e-10 |</span></span>
<span><span class="co">## |   GAR    | 0.38226004  | 8.253424e-10 |</span></span>
<span><span class="co">## |   RFD    | 0.26695978  | 7.395150e-10 |</span></span>
<span><span class="co">## |    BD    | 0.26496790  | 3.248683e-10 |</span></span>
<span><span class="co">## |    BH    | 0.24779725  | 8.792670e-11 |</span></span>
<span><span class="co">## |   NDWI   | 0.20808065  | 6.585551e-10 |</span></span>
<span><span class="co">## |   FAR    | 0.19795883  | 1.349734e-10 |</span></span>
<span><span class="co">## |   SVF    | 0.13094230  | 4.972996e-10 |</span></span>
<span><span class="co">## |    RL    | 0.12311769  | 8.885315e-10 |</span></span>
<span><span class="co">## |   TER    | 0.11640460  | 6.773640e-08 |</span></span>
<span><span class="co">## |   WAR    | 0.10615536  | 5.573880e-10 |</span></span>
<span><span class="co">## |   LSI    | 0.07673167  | 3.213431e-06 |</span></span>
<span><span class="co">## |   DTH    | 0.07628845  | 7.669056e-06 |</span></span>
<span><span class="co">## |   DTP    | 0.07478988  | 7.947200e-10 |</span></span>
<span><span class="co">## |   DTW    | 0.05575932  | 4.071996e-04 |</span></span>
<span><span class="co">## |   DTR    | 0.05285988  | 3.936829e-07 |</span></span>
<span><span class="co">## |   LPI    | 0.02875711  | 8.158332e-01 |</span></span></code></pre></div>
<p><strong>You can access the detailed q statistics by
<code>usfi_opgd$factor</code>.</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">usfi_opgd</span><span class="op">$</span><span class="va">factor</span></span>
<span><span class="co">## # A tibble: 18 × 3</span></span>
<span><span class="co">##    variable `Q-statistic` `P-value`</span></span>
<span><span class="co">##    &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">##  1 DAR             0.439   4.88e-10</span></span>
<span><span class="co">##  2 NDVI            0.397   2.02e-10</span></span>
<span><span class="co">##  3 GAR             0.382   8.25e-10</span></span>
<span><span class="co">##  4 RFD             0.267   7.40e-10</span></span>
<span><span class="co">##  5 BD              0.265   3.25e-10</span></span>
<span><span class="co">##  6 BH              0.248   8.79e-11</span></span>
<span><span class="co">##  7 NDWI            0.208   6.59e-10</span></span>
<span><span class="co">##  8 FAR             0.198   1.35e-10</span></span>
<span><span class="co">##  9 SVF             0.131   4.97e-10</span></span>
<span><span class="co">## 10 RL              0.123   8.89e-10</span></span>
<span><span class="co">## 11 TER             0.116   6.77e- 8</span></span>
<span><span class="co">## 12 WAR             0.106   5.57e-10</span></span>
<span><span class="co">## 13 LSI             0.0767  3.21e- 6</span></span>
<span><span class="co">## 14 DTH             0.0763  7.67e- 6</span></span>
<span><span class="co">## 15 DTP             0.0748  7.95e-10</span></span>
<span><span class="co">## 16 DTW             0.0558  4.07e- 4</span></span>
<span><span class="co">## 17 DTR             0.0529  3.94e- 7</span></span>
<span><span class="co">## 18 LPI             0.0288  8.16e- 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="spade-modeling">SPADE modeling<a class="anchor" aria-label="anchor" href="#spade-modeling"></a>
</h3>
<p><em>SPADE</em> explicitly considers the spatial variance by assigning
the weight of the influence based on spatial distribution and also
minimizes the influence of the number of levels on PD values by using
the multilevel discretization and considering information loss due to
discretization.</p>
<p>When response variable has a strong spatial dependence, maybe
<em>SPADE</em> is a best choice.</p>
<p>The biggest difference between SPADE and native GD and OPGD in actual
modeling is that SPADE requires a spatial weight matrix to calculate
spatial variance.</p>
<p>In <code>gdverse</code>, when you not provide a spatial weight
matrix, it will use <strong>1st order inverse distance weight</strong>
by default, which can be created by
<code><a href="../reference/inverse_distance_weight.html">inverse_distance_weight()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coords</span> <span class="op">=</span> <span class="va">usfi</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_centroid</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wt1</span> <span class="op">=</span> <span class="fu"><a href="../reference/inverse_distance_weight.html">inverse_distance_weight</a></span><span class="op">(</span><span class="va">coords</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">coords</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>You can also use gravity weight by assigning the <code>power</code>
parameter in <code><a href="../reference/inverse_distance_weight.html">inverse_distance_weight()</a></code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt2</span> <span class="op">=</span> <span class="fu"><a href="../reference/inverse_distance_weight.html">inverse_distance_weight</a></span><span class="op">(</span><span class="va">coords</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">coords</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,power <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>You can also use spatial weight matrix from <code>sfdep</code>(which
invoke <code>spdep</code>) or <code>tidyrgeoda</code>(which invoke
`rgeoda``)</p>
<div class="section level4">
<h4 id="using-spatial-weight-matrix-from-sfdep">using spatial weight matrix from sfdep<a class="anchor" aria-label="anchor" href="#using-spatial-weight-matrix-from-sfdep"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt3</span> <span class="op">=</span> <span class="va">usfi</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">if_any</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,<span class="va">is.na</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>nb <span class="op">=</span> <span class="fu">sfdep</span><span class="fu">::</span><span class="fu"><a href="https://sfdep.josiahparry.com/reference/st_contiguity.html" class="external-link">st_contiguity</a></span><span class="op">(</span><span class="va">geom</span><span class="op">)</span>,</span>
<span>         wt <span class="op">=</span> <span class="fu">sfdep</span><span class="fu">::</span><span class="fu"><a href="https://sfdep.josiahparry.com/reference/st_weights.html" class="external-link">st_weights</a></span><span class="op">(</span><span class="va">nb</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/exposition.html" class="external-link">%$%</a></span></span>
<span>  <span class="fu">sfdep</span><span class="fu">::</span><span class="fu"><a href="https://sfdep.josiahparry.com/reference/wt_as_matrix.html" class="external-link">wt_as_matrix</a></span><span class="op">(</span><span class="va">nb</span>,<span class="va">wt</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="using-spatial-weight-matrix-from-tidyrgeoda">using spatial weight matrix from tidyrgeoda<a class="anchor" aria-label="anchor" href="#using-spatial-weight-matrix-from-tidyrgeoda"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt4</span> <span class="op">=</span> <span class="fu">tidyrgeoda</span><span class="fu">::</span><span class="fu">st_contiguity_weights</span><span class="op">(</span><span class="va">usfi</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/coerce.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fl">1</span>,\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/transpose.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The <code>wt3</code> is identical <code>wt4</code></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">wt3</span>,<span class="va">wt4</span><span class="op">)</span></span>
<span><span class="co">## [1] TRUE</span></span></code></pre></div>
<p><strong>We recommend using the inverse distance weight function
<code><a href="../reference/inverse_distance_weight.html">inverse_distance_weight()</a></code> of the <code>gdverse</code>
package to construct a spatial weight matrix if you’re not sure which
spatial weight matrix should to be used as the SPADE paper is using
this.In practice, the appropriate spatial weight matrix is selected
considering the characteristics of the research object and the research
area! </strong></p>
<p>In the following section we will execute <em>SPADE</em> model using
spatial weight matrix <code>wt3</code> which is constructed by queen
contiguity.</p>
<p>The test of <em>SPADE</em> model significance in <code>gdverse</code>
is achieved by randomization null hypothesis use a pseudo-p value,this
calculations are very time-consuming. Default <code>gdverse</code> sets
the <code>permutations</code> parameter to 0 and does not calculate the
pseudo-p value. If you want to calculate the pseudo-p value, specify the
<code>permutations</code> parameter to a number such as 99,999,9999,
etc.</p>
</div>
<div class="section level4">
<h4 id="run-spade">run SPADE<a class="anchor" aria-label="anchor" href="#run-spade"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">usfi_spade</span> <span class="op">=</span> <span class="fu"><a href="../reference/spade.html">spade</a></span><span class="op">(</span><span class="va">SUHI</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">usfi</span><span class="op">)</span>,</span>
<span>                   wt <span class="op">=</span> <span class="va">wt3</span>, discnum <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">22</span>, cores <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">usfi_spade</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##        Spatial Association Detector       </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##                   SPADE Model               </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## | variable | Q-statistic |      P-value      |</span></span>
<span><span class="co">## |:--------:|:-----------:|:-----------------:|</span></span>
<span><span class="co">## |   DAR    | 0.51354520  | No Pseudo-P Value |</span></span>
<span><span class="co">## |   NDVI   | 0.47435470  | No Pseudo-P Value |</span></span>
<span><span class="co">## |   NDWI   | 0.43652650  | No Pseudo-P Value |</span></span>
<span><span class="co">## |   GAR    | 0.42037121  | No Pseudo-P Value |</span></span>
<span><span class="co">## |   RFD    | 0.35902741  | No Pseudo-P Value |</span></span>
<span><span class="co">## |    BD    | 0.35397385  | No Pseudo-P Value |</span></span>
<span><span class="co">## |    BH    | 0.32947163  | No Pseudo-P Value |</span></span>
<span><span class="co">## |   TER    | 0.31556969  | No Pseudo-P Value |</span></span>
<span><span class="co">## |   FAR    | 0.22828609  | No Pseudo-P Value |</span></span>
<span><span class="co">## |   DTR    | 0.22245435  | No Pseudo-P Value |</span></span>
<span><span class="co">## |   DTW    | 0.19009188  | No Pseudo-P Value |</span></span>
<span><span class="co">## |   DTP    | 0.14935992  | No Pseudo-P Value |</span></span>
<span><span class="co">## |   LSI    | 0.14875273  | No Pseudo-P Value |</span></span>
<span><span class="co">## |    RL    | 0.13422740  | No Pseudo-P Value |</span></span>
<span><span class="co">## |   SVF    | 0.13294874  | No Pseudo-P Value |</span></span>
<span><span class="co">## |   LPI    | 0.13054984  | No Pseudo-P Value |</span></span>
<span><span class="co">## |   DTH    | 0.08346346  | No Pseudo-P Value |</span></span>
<span><span class="co">## |   WAR    |     NaN     | No Pseudo-P Value |</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">usfi_spade</span>,slicenum <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/spade/USFI_SPADE_factor-1.png"></p>
<p><strong>You can also access the detailed q statistics by
<code>usfi_spade$factor</code></strong></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">usfi_spade</span><span class="op">$</span><span class="va">factor</span></span>
<span><span class="co">## # A tibble: 18 × 3</span></span>
<span><span class="co">##    variable `Q-statistic` `P-value`        </span></span>
<span><span class="co">##    &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt;            </span></span>
<span><span class="co">##  1 DAR             0.514  No Pseudo-P Value</span></span>
<span><span class="co">##  2 NDVI            0.474  No Pseudo-P Value</span></span>
<span><span class="co">##  3 NDWI            0.437  No Pseudo-P Value</span></span>
<span><span class="co">##  4 GAR             0.420  No Pseudo-P Value</span></span>
<span><span class="co">##  5 RFD             0.359  No Pseudo-P Value</span></span>
<span><span class="co">##  6 BD              0.354  No Pseudo-P Value</span></span>
<span><span class="co">##  7 BH              0.329  No Pseudo-P Value</span></span>
<span><span class="co">##  8 TER             0.316  No Pseudo-P Value</span></span>
<span><span class="co">##  9 FAR             0.228  No Pseudo-P Value</span></span>
<span><span class="co">## 10 DTR             0.222  No Pseudo-P Value</span></span>
<span><span class="co">## 11 DTW             0.190  No Pseudo-P Value</span></span>
<span><span class="co">## 12 DTP             0.149  No Pseudo-P Value</span></span>
<span><span class="co">## 13 LSI             0.149  No Pseudo-P Value</span></span>
<span><span class="co">## 14 RL              0.134  No Pseudo-P Value</span></span>
<span><span class="co">## 15 SVF             0.133  No Pseudo-P Value</span></span>
<span><span class="co">## 16 LPI             0.131  No Pseudo-P Value</span></span>
<span><span class="co">## 17 DTH             0.0835 No Pseudo-P Value</span></span>
<span><span class="co">## 18 WAR           NaN      No Pseudo-P Value</span></span></code></pre></div>
<p>The result of <code>WAR</code> is <code>NA</code> and you can also
see a big difference between the OPGD and SPADE model. The results of
SPADE are more reliable in most cases.</p>
<p>We demonstrate the rationality of NA values calculated of
<code>WAR</code> in the following section:</p>
</div>
</div>
<div class="section level3">
<h3 id="spade-na-result-explained">SPADE NA result explained<a class="anchor" aria-label="anchor" href="#spade-na-result-explained"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">WAR</span> <span class="op">=</span> <span class="va">usfi</span><span class="op">$</span><span class="va">WAR</span></span>
<span><span class="fu">skimr</span><span class="fu">::</span><span class="fu">skim</span><span class="op">(</span><span class="va">WAR</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">WAR</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">1037</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">numeric</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table">
<colgroup>
<col width="18%">
<col width="13%">
<col width="18%">
<col width="6%">
<col width="6%">
<col width="4%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="6%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">data</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.01</td>
<td align="right">0.04</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.73</td>
<td align="left">▇▁▁▁▁</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">usfi</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">WAR</span><span class="op">)</span>,</span>
<span>               color<span class="op">=</span><span class="st">'white'</span>,</span>
<span>               fill<span class="op">=</span><span class="st">'gray60'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/spade/WAR_Hist-1.png"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">moments</span><span class="fu">::</span><span class="fu">skewness</span><span class="op">(</span><span class="va">WAR</span><span class="op">)</span></span>
<span><span class="co">## [1] 11.6917</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">WAR</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Shapiro-Wilk normality test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  WAR</span></span>
<span><span class="co">## W = 0.14693, p-value &lt; 2.2e-16</span></span></code></pre></div>
<p>From the histogram of <code>WAR</code>,its skewness and the result of
shapiro.test, you will find that the WAR variable is heavily skewed,
with a large number of zeros, which do not provide sufficient
information for modeling SUHI.</p>
<p>In fact, the WAR variable represents the proportion of the water area
of each block, and the WAR value is NA in the SPADE result probably
because it can’t provide sufficient information for modeling SUHI.</p>
<p>Let’s look at the specific calculation process of the PSMD(power of
spatial and multilevel discretization determinant) value corresponding
to WAR:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">3</span><span class="op">:</span><span class="fl">22</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">.k</span><span class="op">)</span> <span class="fu"><a href="../reference/st_unidisc.html">st_unidisc</a></span><span class="op">(</span><span class="va">usfi</span><span class="op">$</span><span class="va">WAR</span>,<span class="va">.k</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>                  <span class="fu"><a href="../reference/factor_detector.html">factor_detector</a></span><span class="op">(</span><span class="va">usfi</span><span class="op">$</span><span class="va">WAR</span>, <span class="va">.</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>                  <span class="op">{</span><span class="va">.</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">##  [1] 0.00000000 0.05795105 0.08069138 0.10177158 0.12117267 0.13904284 0.15732689 0.17377009</span></span>
<span><span class="co">##  [9] 0.19092712 0.20432876 0.22190151 0.23780494 0.25057152 0.26498423 0.28119643 0.29570781</span></span>
<span><span class="co">## [17] 0.30353784 0.32068449 0.33494156 0.34531717</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fl">3</span><span class="op">:</span><span class="fl">22</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">.k</span><span class="op">)</span> <span class="fu"><a href="../reference/st_unidisc.html">st_unidisc</a></span><span class="op">(</span><span class="va">usfi</span><span class="op">$</span><span class="va">WAR</span>,<span class="va">.k</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>                   <span class="fu"><a href="../reference/psd_spade.html">psd_spade</a></span><span class="op">(</span><span class="va">usfi</span><span class="op">$</span><span class="va">WAR</span>, <span class="va">.</span>, <span class="va">wt3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##  [1]  0.0000000 -0.4065480 -0.3942882 -0.4219084 -0.6231376 -0.7273617 -0.7462245 -0.5883158</span></span>
<span><span class="co">##  [9] -0.4720283 -0.4902740 -0.3850580 -0.3185052 -0.3402303 -0.3119740 -0.3468160 -0.3244028</span></span>
<span><span class="co">## [17] -0.3453713 -0.3221619 -0.2500152 -0.2302331</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fl">3</span><span class="op">:</span><span class="fl">22</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">.k</span><span class="op">)</span> <span class="fu"><a href="../reference/st_unidisc.html">st_unidisc</a></span><span class="op">(</span><span class="va">usfi</span><span class="op">$</span><span class="va">WAR</span>,<span class="va">.k</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>                   <span class="fu"><a href="../reference/cpsd_spade.html">cpsd_spade</a></span><span class="op">(</span><span class="va">usfi</span><span class="op">$</span><span class="va">SUHI</span>, <span class="va">usfi</span><span class="op">$</span><span class="va">WAR</span>, <span class="va">.</span>, <span class="va">wt3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##  [1]         NaN -0.15912828 -0.21327657 -0.27536506 -0.09128105 -0.03375476 -0.15168436</span></span>
<span><span class="co">##  [8] -0.18804177 -0.23465648 -0.29911716 -0.35586536 -0.41570044 -0.43172541 -0.41268215</span></span>
<span><span class="co">## [15] -0.52127019 -0.57350020 -0.48780407 -0.34204498 -0.60269473 -1.11353340</span></span></code></pre></div>
<p>In most cases, we use linear regression to explore linear
relationships between variables and select appropriate variables for
subsequent modeling through methods such as VIF. Here we examine the
effect of removing the WAR variable on VIF and linear models:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm.modelOne</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">SUHI</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">usfi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm.modelOne</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = SUHI ~ ., data = st_drop_geometry(usfi))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -4.1991 -0.6899 -0.0366  0.6837  3.7666 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  22.156854   5.003326   4.428 1.05e-05 ***</span></span>
<span><span class="co">## LPI          -0.002280   0.002701  -0.844  0.39872    </span></span>
<span><span class="co">## LSI          -0.004190   0.023320  -0.180  0.85746    </span></span>
<span><span class="co">## GAR           6.869974   0.902865   7.609 6.27e-14 ***</span></span>
<span><span class="co">## DAR           6.746594   0.829310   8.135 1.19e-15 ***</span></span>
<span><span class="co">## WAR           5.283058   1.784052   2.961  0.00313 ** </span></span>
<span><span class="co">## TER          -1.388985   0.670337  -2.072  0.03851 *  </span></span>
<span><span class="co">## NDVI        -15.268701   1.620501  -9.422  &lt; 2e-16 ***</span></span>
<span><span class="co">## NDWI        -15.408610   2.127737  -7.242 8.72e-13 ***</span></span>
<span><span class="co">## DTH           0.015604   0.012255   1.273  0.20318    </span></span>
<span><span class="co">## DTP           0.091178   0.098705   0.924  0.35584    </span></span>
<span><span class="co">## DTR          -0.069387   0.064638  -1.073  0.28331    </span></span>
<span><span class="co">## DTW          -0.195546   0.067418  -2.901  0.00381 ** </span></span>
<span><span class="co">## BH            0.197986   0.034505   5.738 1.26e-08 ***</span></span>
<span><span class="co">## BD            6.151962   2.181999   2.819  0.00490 ** </span></span>
<span><span class="co">## RL            0.008593   0.228118   0.038  0.96996    </span></span>
<span><span class="co">## RFD           0.117208   0.741697   0.158  0.87447    </span></span>
<span><span class="co">## SVF         -22.397352   4.954590  -4.521 6.89e-06 ***</span></span>
<span><span class="co">## FAR          -1.260657   0.112759 -11.180  &lt; 2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 1.06 on 1018 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.6173, Adjusted R-squared:  0.6106 </span></span>
<span><span class="co">## F-statistic: 91.23 on 18 and 1018 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html" class="external-link">vif</a></span><span class="op">(</span><span class="va">lm.modelOne</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble_row</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                      names_to <span class="op">=</span> <span class="st">'variable'</span>,</span>
<span>                      values_to <span class="op">=</span> <span class="st">'VIF'</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 18 × 2</span></span>
<span><span class="co">##    variable    VIF</span></span>
<span><span class="co">##    &lt;chr&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">##  1 LPI        1.68</span></span>
<span><span class="co">##  2 LSI        1.50</span></span>
<span><span class="co">##  3 GAR       31.1 </span></span>
<span><span class="co">##  4 DAR       28.5 </span></span>
<span><span class="co">##  5 WAR        5.85</span></span>
<span><span class="co">##  6 TER        1.18</span></span>
<span><span class="co">##  7 NDVI      20.5 </span></span>
<span><span class="co">##  8 NDWI      13.2 </span></span>
<span><span class="co">##  9 DTH        1.15</span></span>
<span><span class="co">## 10 DTP        2.06</span></span>
<span><span class="co">## 11 DTR        1.15</span></span>
<span><span class="co">## 12 DTW        2.00</span></span>
<span><span class="co">## 13 BH        31.9 </span></span>
<span><span class="co">## 14 BD       105.  </span></span>
<span><span class="co">## 15 RL         2.96</span></span>
<span><span class="co">## 16 RFD       89.4 </span></span>
<span><span class="co">## 17 SVF        3.02</span></span>
<span><span class="co">## 18 FAR       31.3</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm.modelTwo</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">SUHI</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">usfi</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">WAR</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm.modelTwo</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = SUHI ~ ., data = select(st_drop_geometry(usfi), </span></span>
<span><span class="co">##     -WAR))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -4.1752 -0.7118 -0.0227  0.6896  3.6784 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  21.011090   5.007323   4.196 2.95e-05 ***</span></span>
<span><span class="co">## LPI          -0.000917   0.002671  -0.343 0.731475    </span></span>
<span><span class="co">## LSI          -0.002172   0.023399  -0.093 0.926046    </span></span>
<span><span class="co">## GAR           5.283103   0.729402   7.243 8.64e-13 ***</span></span>
<span><span class="co">## DAR           5.300795   0.672909   7.877 8.53e-15 ***</span></span>
<span><span class="co">## TER          -1.174510   0.668949  -1.756 0.079431 .  </span></span>
<span><span class="co">## NDVI        -13.026040   1.438097  -9.058  &lt; 2e-16 ***</span></span>
<span><span class="co">## NDWI        -10.693806   1.416860  -7.548 9.82e-14 ***</span></span>
<span><span class="co">## DTH           0.011362   0.012217   0.930 0.352593    </span></span>
<span><span class="co">## DTP           0.115158   0.098747   1.166 0.243809    </span></span>
<span><span class="co">## DTR          -0.058443   0.064778  -0.902 0.367161    </span></span>
<span><span class="co">## DTW          -0.226617   0.066850  -3.390 0.000726 ***</span></span>
<span><span class="co">## BH            0.192503   0.034587   5.566 3.34e-08 ***</span></span>
<span><span class="co">## BD            5.951972   2.189252   2.719 0.006665 ** </span></span>
<span><span class="co">## RL            0.061282   0.228288   0.268 0.788413    </span></span>
<span><span class="co">## RFD           0.100502   0.744497   0.135 0.892644    </span></span>
<span><span class="co">## SVF         -19.414910   4.869603  -3.987 7.17e-05 ***</span></span>
<span><span class="co">## FAR          -1.227348   0.112624 -10.898  &lt; 2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 1.064 on 1019 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.614,  Adjusted R-squared:  0.6076 </span></span>
<span><span class="co">## F-statistic: 95.36 on 17 and 1019 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html" class="external-link">vif</a></span><span class="op">(</span><span class="va">lm.modelTwo</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble_row</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                      names_to <span class="op">=</span> <span class="st">'variable'</span>,</span>
<span>                      values_to <span class="op">=</span> <span class="st">'VIF'</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 17 × 2</span></span>
<span><span class="co">##    variable    VIF</span></span>
<span><span class="co">##    &lt;chr&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">##  1 LPI        1.63</span></span>
<span><span class="co">##  2 LSI        1.50</span></span>
<span><span class="co">##  3 GAR       20.2 </span></span>
<span><span class="co">##  4 DAR       18.6 </span></span>
<span><span class="co">##  5 TER        1.16</span></span>
<span><span class="co">##  6 NDVI      16.0 </span></span>
<span><span class="co">##  7 NDWI       5.83</span></span>
<span><span class="co">##  8 DTH        1.13</span></span>
<span><span class="co">##  9 DTP        2.05</span></span>
<span><span class="co">## 10 DTR        1.15</span></span>
<span><span class="co">## 11 DTW        1.96</span></span>
<span><span class="co">## 12 BH        31.8 </span></span>
<span><span class="co">## 13 BD       104.  </span></span>
<span><span class="co">## 14 RL         2.94</span></span>
<span><span class="co">## 15 RFD       89.4 </span></span>
<span><span class="co">## 16 SVF        2.90</span></span>
<span><span class="co">## 17 FAR       31.0</span></span></code></pre></div>
<p>You can see that the model does not change much before and after
removing the WAR variable.In other words, WAR does not do much to model
SUHI.</p>
<p>This suggests another use of <code>SPADE</code> model for selecting
modeling variables.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://spatlyu.github.io/" class="external-link">Wenbo Lv</a>, <a href="https://yongzesong.com/" class="external-link">Yongze Song</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
